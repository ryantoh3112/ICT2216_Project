{% extends 'base.html.twig' %}

{% block title %}{{ event.name }} | Event Details{% endblock %}

{% block body %}
<div class="container py-5">
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-body mb-3 position-relative">
      <h1 class="card-title display-5 fw-bold mb-3">{{ event.name }}</h1>
      {% if event.imagepath %}
        <img src="{{ asset(event.imagepath) }}"
             alt="{{ event.name }} image"
             class="img-fluid rounded mb-3">
      {% endif %}
      <p><strong>Organiser:</strong> {{ event.organiser|default('N/A') }}</p>
      <p><strong>Ticketing Period:</strong>
        {{ event.purchaseStartDate|date('d M Y (D)') }}
        ~
        {{ event.purchaseEndDate|date('d M Y (D)') }}
      </p>
      <p><strong>Venue:</strong> {{ event.venue.name }}</p>
      <p><strong>Capacity:</strong> {{ event.capacity }}</p>

      <a href="{{ path('event_select_ticket', { id: event.id }) }}"
         class="btn btn-success position-absolute"
         style="width:20%; bottom: 0; right: 0;">
        Purchase Tickets
      </a>
    </div>
  </div>

  {# Description #}
  <div class="row gy-4">
    <div class="col-12">
      <div class="card border border-dark border-2 shadow-sm">
        <div class="card-body">
          <h4 class="card-title text-dark">Description</h4>
          <p class="card-text">
            {{ event.description|default('No description available.') }}
          </p>
        </div>
      </div>
    </div>
  </div>

  {# Ticket Pricing #}
  <div class="row gy-4 mt-4">
    <div class="col-12">
      <div class="card border border-secondary border-2 shadow-sm">
        <div class="card-body">
          <h4 class="card-title text-secondary">Ticket Pricing</h4>
          {% if ticketTypes is not empty %}
            <table class="table">
              <thead>
                <tr>
                  <th>Type</th>
                  <th>Price (SGD)</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                {% for type in ticketTypes %}
                  <tr>
                    <td>{{ type.name }}</td>
                    <td>{{ type.price|number_format(2, '.', ',') }}</td>
                    <td>{{ type.description|default('–') }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          {% else %}
            <p class="text-muted fst-italic">No ticket types defined yet.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  {# Exchange & Refund Policy #}
  <div class="row gy-4 mt-4">
    <div class="col-12">
      <div class="card border border-dark border-2 shadow-sm">
        <div class="card-body">
          <h4 class="card-title text-dark">Exchange &amp; Refund Policy</h4>
          <ul class="card-text">
            <li>All sales are final. Tickets are non-refundable and non-exchangeable except as stated below.</li>
            <li>
              <strong>Event Cancellation or Postponement:</strong>
              Should the event be cancelled, you will receive a full refund of your ticket price
              to your original payment method within 14 business days.
            </li>
            <li>
              <strong>Date/Time Changes:</strong>
              If the event is rescheduled, your existing ticket will be valid for the new date;
              no exchange fee will apply.
            </li>
            <li>
              <strong>Lost or Stolen Tickets:</strong>
              Replacement tickets can be issued for a S$10 handling fee—proof of purchase required.
            </li>
            <li>
              <strong>Resale & Transfer:</strong>
              Tickets may be transferred to another person via our official portal up to 24hrs before the event.
              Unauthorized resale (e.g. third-party marketplaces) may result in ticket cancellation without refund.
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  {# Admission Policy #}
  <div class="row gy-4 mt-4">
    <div class="col-12">
      <div class="card border border-secondary border-2 shadow-sm">
        <div class="card-body">
          <h4 class="card-title text-secondary">Admission Policy</h4>
          <p class="card-text">
            All patrons need a valid ticket. Printed/electronic tickets must be produced for admission.
            Individuals and children aged 4 years old and above will be required to purchase a ticket.
            Children aged 12 years old and below must always be accompanied by an adult ticketholder.
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-5 d-flex justify-content-between align-items-center">
    <a href="{{ path('event_list') }}"
       class="btn btn-outline-secondary mt-4">
      ← Back to Events
    </a>
    {# Later: your Add-to-Cart button here #}
  </div>
</div>
{% endblock %}
